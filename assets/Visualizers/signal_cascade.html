<!-- SIGNAL CASCADE — Packet Waterfall Visualizer (Drop-In) -->
<div class="sc-waterfall" role="img" aria-label="Signal Cascade visualizer">
  <div class="sc-noise"></div>
  <div class="sc-scanlines"></div>

  <div class="sc-hud">
    <div class="sc-left">
      <div class="sc-band">SYNTHETIC SOULS</div>
      <div class="sc-track">SIGNAL CASCADE</div>
      <div class="sc-sub">PACKETS · PULSES · THROUGHPUT</div>
    </div>
    <div class="sc-right">
      <div class="sc-chip">LIVE LINK</div>
      <div class="sc-chip sc-chip2">CASCADE MODE</div>
    </div>
  </div>

  <div class="sc-traces">
    <canvas class="sc-trace" width="1200" height="260"></canvas>
  </div>

  <div class="sc-packets" aria-hidden="true"></div>

  <div class="sc-footer">
    <div class="sc-dot"></div>
    <div class="sc-footerText">WE DON’T PERFORM. WE APPEAR.</div>
  </div>
</div>

<style>
  .sc-waterfall{
    position:relative; width:100%; max-width:980px; height:520px; margin:0 auto;
    border-radius:18px; overflow:hidden;
    background: radial-gradient(1200px 520px at 30% 30%, #1b0b3a 0%, #070917 55%, #04050e 100%);
    box-shadow:0 18px 60px rgba(0,0,0,.6);
  }
  .sc-noise{
    position:absolute; inset:0;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.22'/%3E%3C/svg%3E");
    mix-blend-mode:overlay; opacity:.55;
  }
  .sc-scanlines{
    position:absolute; inset:0;
    background: repeating-linear-gradient(0deg, rgba(255,255,255,.03) 0 1px, rgba(0,0,0,0) 1px 6px);
    opacity:.28; mix-blend-mode:overlay;
  }
  .sc-hud{
    position:absolute; inset:18px 18px auto 18px;
    display:flex; justify-content:space-between; gap:18px;
    padding:14px 16px; border-radius:14px;
    background:rgba(8,10,20,.48);
    border:1px solid rgba(120,210,255,.16);
    backdrop-filter: blur(10px);
  }
  .sc-band{ font:800 12px/1 system-ui,Segoe UI,Roboto,Arial; letter-spacing:.22em; color:rgba(210,235,255,.82); }
  .sc-track{
    margin-top:6px;
    font:900 32px/1.05 system-ui,Segoe UI,Roboto,Arial;
    letter-spacing:.10em;
    color:rgba(245,250,255,.92);
    text-shadow: 0 0 22px rgba(70,220,255,.22), 0 0 22px rgba(185,90,255,.18);
  }
  .sc-sub{ margin-top:6px; font:700 11px/1 system-ui; letter-spacing:.18em; color:rgba(170,200,255,.66); }
  .sc-right{ display:flex; flex-direction:column; gap:10px; align-items:flex-end; }
  .sc-chip{
    font:800 11px/1 system-ui; letter-spacing:.18em;
    padding:10px 12px; border-radius:999px;
    background:rgba(0,0,0,.22);
    border:1px solid rgba(70,220,255,.22);
    color:rgba(220,245,255,.86);
    box-shadow:0 0 24px rgba(70,220,255,.10);
  }
  .sc-chip2{ border-color: rgba(255,90,200,.22); box-shadow:0 0 24px rgba(255,90,200,.08); }

  .sc-traces{
    position:absolute; left:18px; right:18px; top:140px; height:260px;
    border-radius:16px;
    background:rgba(6,8,18,.32);
    border:1px solid rgba(255,255,255,.07);
    overflow:hidden;
  }
  .sc-trace{ width:100%; height:100%; display:block; }

  .sc-packets{
    position:absolute; inset:0;
    pointer-events:none;
    filter: drop-shadow(0 0 8px rgba(70,220,255,.22));
  }
  .sc-packets i{
    position:absolute; width:10px; height:18px; border-radius:4px;
    background: linear-gradient(180deg, rgba(70,220,255,.92), rgba(185,90,255,.58), rgba(255,90,200,.20));
    opacity:.9;
    animation: scFall linear infinite;
    transform: translateY(-40px);
  }
  .sc-packets i::after{
    content:""; position:absolute; left:-10px; right:-10px; top:50%;
    height:1px; background: linear-gradient(90deg, transparent, rgba(70,220,255,.55), transparent);
    opacity:.25;
  }

  @keyframes scFall{
    to{ transform: translateY(620px); opacity:.1; }
  }

  .sc-footer{
    position:absolute; left:18px; right:18px; bottom:16px;
    display:flex; gap:10px; align-items:center;
    padding:12px 14px; border-radius:14px;
    background:rgba(8,10,20,.40);
    border:1px solid rgba(255,255,255,.07);
    backdrop-filter: blur(10px);
  }
  .sc-dot{
    width:10px; height:10px; border-radius:99px;
    background: rgba(70,220,255,.95);
    box-shadow:0 0 18px rgba(70,220,255,.30), 0 0 22px rgba(185,90,255,.18);
    animation: scBlink 1.3s ease-in-out infinite;
  }
  @keyframes scBlink{ 0%,100%{opacity:.25} 50%{opacity:1} }
  .sc-footerText{
    font:800 12px/1 system-ui; letter-spacing:.22em;
    color:rgba(200,220,255,.76);
  }

  @media (max-width:640px){
    .sc-waterfall{ height:540px; }
    .sc-track{ font-size:26px; }
    .sc-traces{ top:150px; height:250px; }
  }
</style>

<script>
(function(){
  const root = document.querySelector(".sc-waterfall");
  if(!root) return;

  // Build packet field (no bars, no grids)
  const holder = root.querySelector(".sc-packets");
  const PACKETS = 120;
  const packets = [];
  for(let i=0;i<PACKETS;i++){
    const el = document.createElement("i");
    const x = Math.random()*100;
    const w = 6 + Math.random()*12;
    const h = 10 + Math.random()*28;
    el.style.left = x + "%";
    el.style.width = w + "px";
    el.style.height = h + "px";
    el.style.opacity = (0.25 + Math.random()*0.75).toFixed(2);
    el.style.animationDuration = (1.2 + Math.random()*2.8).toFixed(2) + "s";
    el.style.animationDelay = (-Math.random()*3).toFixed(2) + "s";
    holder.appendChild(el);
    packets.push(el);
  }

  // Trace canvas: network-throughput lines + “glitch spikes”
  const c = root.querySelector("canvas.sc-trace");
  const ctx = c.getContext("2d");
  const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
  function resize(){
    const rect = c.getBoundingClientRect();
    c.width = Math.floor(rect.width * DPR);
    c.height = Math.floor(rect.height * DPR);
  }
  resize();
  window.addEventListener("resize", resize);

  let t = 0;
  let audioBoost = 0.35;

  // Optional audio-reactive: if an <audio> exists, click to sync.
  const audio = document.querySelector("audio");
  let analyser, data, ac;
  async function enableAudio(){
    if(!audio || !window.AudioContext) return;
    ac = new (window.AudioContext || window.webkitAudioContext)();
    const src = ac.createMediaElementSource(audio);
    analyser = ac.createAnalyser();
    analyser.fftSize = 512;
    src.connect(analyser);
    analyser.connect(ac.destination);
    data = new Uint8Array(analyser.frequencyBinCount);
    if(ac.state !== "running") await ac.resume();
    window.removeEventListener("click", enableAudio);
  }
  window.addEventListener("click", enableAudio);

  function getLevel(){
    if(!analyser) return 0.22 + 0.18*Math.sin(t*0.7);
    analyser.getByteFrequencyData(data);
    let sum = 0;
    for(let i=6;i<90;i++) sum += data[i];
    return Math.min(1, (sum/84)/255);
  }

  function draw(){
    t += 0.016;
    const level = getLevel();
    audioBoost = 0.30 + level*0.95;

    // speed packets by loudness
    packets.forEach((p, idx)=>{
      const base = 1.2 + (idx%7)*0.12;
      p.style.animationDuration = (Math.max(0.7, 3.2 - audioBoost*1.8) + base*0.12).toFixed(2) + "s";
    });

    // traces
    const W = c.width, H = c.height;
    ctx.clearRect(0,0,W,H);

    // background glow
    const g = ctx.createRadialGradient(W*0.35,H*0.4, 0, W*0.35,H*0.4, W*0.85);
    g.addColorStop(0, "rgba(70,220,255,0.10)");
    g.addColorStop(0.5, "rgba(185,90,255,0.08)");
    g.addColorStop(1, "rgba(0,0,0,0)");
    ctx.fillStyle = g;
    ctx.fillRect(0,0,W,H);

    // draw 3 throughput lines
    const lines = [
      {amp: 0.22, sp: 1.1, colA:"rgba(70,220,255,0.85)", colB:"rgba(70,220,255,0.12)"},
      {amp: 0.16, sp: 1.6, colA:"rgba(185,90,255,0.75)", colB:"rgba(185,90,255,0.10)"},
      {amp: 0.12, sp: 2.2, colA:"rgba(255,90,200,0.55)", colB:"rgba(255,90,200,0.08)"},
    ];

    lines.forEach((L, li)=>{
      ctx.beginPath();
      const mid = H*(0.30 + li*0.20);
      for(let x=0;x<=W;x+=6){
        const n = Math.sin((x/W)*Math.PI*2*(1.5+li*0.35) + t*L.sp);
        const wob = Math.sin((x/W)*Math.PI*2*(4.2+li) + t*(L.sp*1.8));
        const y = mid + (n*0.65 + wob*0.35) * (H*L.amp) * audioBoost;
        if(x===0) ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
      }
      ctx.strokeStyle = L.colA;
      ctx.lineWidth = 2*DPR;
      ctx.stroke();

      // underglow
      ctx.lineTo(W, mid);
      ctx.lineTo(0, mid);
      ctx.closePath();
      ctx.fillStyle = L.colB;
      ctx.fill();
    });

    // glitch spikes (packet bursts)
    const spikes = 8 + Math.floor(level*14);
    for(let i=0;i<spikes;i++){
      const x = Math.random()*W;
      const y = (0.22 + Math.random()*0.56)*H;
      const h = (10 + Math.random()*80) * DPR * (0.6 + level);
      ctx.fillStyle = Math.random()<0.5 ? "rgba(70,220,255,0.35)" : "rgba(185,90,255,0.28)";
      ctx.fillRect(x, y, 2.2*DPR, h);
    }

    requestAnimationFrame(draw);
  }
  draw();
})();
</script>